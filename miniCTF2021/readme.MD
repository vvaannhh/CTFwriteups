# miniCTF 2021

Để chào mừng các tân sinh viên và những người có đam mê và muốn tìm hiểu về Cyber Security, ISP Club chúng mình đã tổ chức cuộc thi thường niên miniCTF và đây là writeup cho miniCTF năm 2021.

### Firstlooking  

### Overview
 | Title | Category | Flag
 | ------ | ------  | ------ |
 | [Discord]() | Welcome |  `ISPCLUB {4r3_y0u_r34dy}` |
 | [Dōnyū]() | Welcome | `ISPCLUB{900D_LUCK_B4BY}` |
 | [Chuunin Exam](/miniCTF2021/miniCTF2021_file/Chuunin-Exam/Chuunin-Exam.md) |	Crypto	| `ISPCLUB{s3cr3t_pr0t3ct0r}` |
 | [Base no Jutsu]() | Crypto |  `ISPCLUB{b4s3_1s_n0t_tk4t_d1ff1cult}` |
 | [Gravity Falls Bill]() | Crypto |  `ISPCLUB{BJLL_CJPKER}` |
 | [Covi no Dokumushi]() | Forensic | `ISPCLUB{11919}` |
 | [Daichidoukaku]()| Forensic |  `ISPCLUB{5p1it_91f}` |
 | [Sagasu no Jutsu]() | Forensic |  `ISPCLUB{5uck_4_l0n9_w4y}` |
 | [Rasen...Deku]() | Forensic |`ISPCLUB{m4q3ky0u_sk4rjnq4n}` |
 | [Baika]() | Forensic |  `ISPCLUB{ch0_b41k4_n0_jut5u}` |
 | [Chess but not so Stress](#) |General skill|`ISPCLUB{G4MB1T_QU3EN}` |
 | [Earth Hour]() | General skill| `ISPCLUB{OUREARTH}` |
 | [Himitsu No Ninmu](/miniCTF2021/miniCTF2021_file/himitsu-no-nimu/README.md) | General skill| `ISPCLUB{w3lc0me_t0_1nn3r_s4nCtuM}` |
 | [Start the new schoolyear]() | General skill |`ISPCLUB{L1nux_1z_v3ry_c0nV3n1EnT}` |
 | [Sasuke’s Paw Encyclopedia](/miniCTF2021/miniCTF2021_file/sasuke_paw/README.MD) | General skill | `ISPCLUB{SO_WEIRD_CAT}` |
 | [Faster!!!]() |Misc | `ISPCLUB{r1ck_r0ll_4g41n}`|
 | [First Generation]() | 	Misc | `ISPCLUB{CAPTURE_THE_FLAG}` |
 | [Kakuremino no Jutsu]() | Misc |`ISPCLUB{h1d3_f1l3_1n_p1ctur3}`|
 | [Honest or Tricky](/miniCTF2021/miniCTF2021_file/tricky_or_honest/README.md) | Programming | `ISPCLUB{m4th_f0R_dUmm13S!!!!!!!}` |  
 | [Tricky or Honest](/miniCTF2021/miniCTF2021_file/tricky_or_honest/README.md) | Programming | `ISPCLUB{F45T_a5_71ghtN1n9!!!!}` |
 | [Reverse no Jutsu]() | RE |`ISPCLUB{s3xY_n0_jnt5u_K4i_h4r3m}` |
 | [Kakureru]() | RE |`ISPCLUB{W3ll_c0m3_t0_r3vers!n9}` |
 | [Furipputon - Reveal of the Truth](/miniCTF2021/miniCTF2021_file/Furipputon.md) | RE  |`ISPCLUB{DekuHoho}`|
 | [Isekai with truck-kun](/miniCTF2021/miniCTF2021_file/isekai/README.md) | Warm up |`ISPCLUB{p0w3R_oF_l0V3!!!}`|
 | [PHP no jutsu]() | Web | `ISPCLUB{php_1s_Suck}`|
 | [Deku's Bird]()  | Web | `ISPCLUB{4_G00D_PL4Y3R}`|
 | [Kieru Odama Genso]() | Web | `ISPCLUB{c$$_!5_v3ry_34sy}`|
 | [Beginner]() | Web | `ISPCLUB{Not_the_first_time_huhh??}`|
 | [ISP Ichizoku SHOP]() | Web | `ISPCLUB{dung_gian_lan}`|
 | [Shinra Tensei]() | Web | `ISPCLUB{__H0W_TH3__F^CK_D1D__Y0U_93t__F14G_????}`|
 
 # Welcome: Discord

#### Challenge
Hành trình thu thập vô cùng nguy hiểm và khó lường. Hãy để gia tộc ISP giúp đỡ các bạn:
https://discord.gg/B7xFmWXp5F

#### Solution
Ở bài này mình có thể tìm thấy flag trong channels Rules của server discord [miniCTF2021](https://discord.gg/B7xFmWXp5F)

Flag: ``` ISPCLUB{4r3_y0u_r34dy} ```

# Welcome Dōnyū
#### Challenge
Bạn sắp đặt chân vào thế giới mới. Hãy khám phá nó ...

[Donyu.txt](miniCTF2021_file/Donyu/Donyu.txt)

#### Solution

Đọc đoạn text mà đề cho ta dễ dàng thấy được flag nằm ở cuối file.
```
Làng PTIT (PTITgakure)  từ lâu đã nổi tiếng với các thuật Phong Ấn do gia tộc ISP (ISP Ichizoku)  thực hiện.
Trước kia họ đã dùng chính thuật Phong Ấn của mình để phong ấn các nhẫn thuật cổ xưa, phân tán khắp Nhẫn giới và giam giữ trong các mê cung đầy bí hiểm mà người thường không thể xâm nhập được.
Tổ chức AkatXienPan được thành lập với mục đích thu thập lại các nhẫn thuật đó để gây ra chiến tranh, phá hủy thế giới. 1 thành viên cực mạnh của tổ chức này là Hiruyzawa Kuhan nay cũng đã khám phá rất nhiều mê cung và nắm cho mình rất nhiều nhẫn thuật mạnh.
Chính vì thế hãy luyện tập, level up kĩ năng, dấn thân đi khám phá các mê cung để thu thập lại các bí thuật trước khi Hiruyzawa Kuhan có được nó để đem lại bình yên cho làng PTIT cũng như gìn giữ hòa bình nơi Nhẫn giới nào!!!
ISP Ichizoku đã chuẩn bị một món quà nho nhỏ tặng bạn. Hãy thử làm quen với nó trước khi tham gia thu thập các bí thuật: ISPCLUB{900D_LUCK_B4BY}.
```
Flag: ``` ISPCLUB{900D_LUCK_B4BY} ```

# Crypto: Chuunin Exam
#### Challenge
Kỳ thi Chunnin sắp đến gần, hãy chuẩn bị thật tốt để có thể học hỏi từ các Genin khác và có cơ hội được thăng cấp trở thành Chunnin đầu tiên trong thế hệ D21 làng PTIT!

```$ nc 150.230.217.225 2026 ```  
#### Solution  
Sau intro ngắn thì ta thấy đề bài xuất hiện.  
  
## Stage 1  
  
```
***
First Stage: Written test

Given a ciphertext encrypted using the Roman method of cryptography...



My ciphertext:

Nofovyzon kbyexn 100 LM, xyd exdsv 9dr-moxdebi, Mkockb mszrob gkc mbkmuon gsdr dro nscmyfobi yp pboaeoxmi kxkvicsc.



What is the messages?
````  
  
Tra google với từ khoá tương tự với "Roman encrypt" ta có kết quả là mã hoá Caesar (Caesar Cipher) ở ngay trang đầu.
  
Mã hoá Caesar là kiểu mã hoá bằng phương pháp dịch các chữ cái trong bảng chữ cái đi k ký tự, với k là khoá của mã hoá. 
Ở bài này ta được cho một đoạn mật mã đã mã hoá, nhưng chưa biết key. Ta sẽ tiến hành brute key trong khoảng từ 1 - 25 (Do bảng chữ cái có 26 ký tự) để tìm ra bản rõ.  
  
Ở challenge này, key được sinh ngẫu nhiên. [Decrypt](https://cryptii.com/) với k = 16 ta có plaintext:
```
Developed around 100 BC, not until 9th-century, Caesar cipher was cracked with the discovery of frequency analysis.
```

## Stage 2  
```
***
Second Stage: Forest of Death

You have to bring your team's Scroll to the Building whose position is encrypted by an ancient Greek technique...



My ciphertext:

Lpn_oocScrrcatyyt_pte2tad0el_2dea6_ t_b _ey 



What is the messages?
```
Lần này thì từ khoá ta cần quan tâm sẽ là "Greek encrypt" và cũng dễ dàng xác định đó là kiểu mã hoá Scytale.
Đây là kiểu mã hoá của người Hy Lạp cổ, sử dụng một tấm vải mảnh dài và viết lẻ từng chữ cái lên trên "tấm vải" được tạo ra từ việc cuốn tấm vải quanh một đoạn gỗ. 
Sau khi viết xong, mảnh vải sẽ được gỡ khỏi đoạn gỗ và trở thành đoạn mã tối nghĩa nếu chỉ nhìn tấm vải.  
  
Để giải mã, ta sẽ cần tìm một "đoạn gỗ" có kích thước tương tự với đoạn mà người mã hoá đã sử dụng. [Giải mã](https://dencode.com/cipher/scytale) với "đoạn gỗ" có số ký tự trên một vòng cuốn key = 4 ta có plaintext:
```
Located_at_port_2026_encrypted_by_Scytale  
```

## Stage 3: Final
```
***
Final Stage: Team Fight

The key of teamwork in a fight is to communicate secretly.
This was created at the end of the First World War in German.



Your team using this machine:

_________________________________________________________________

Machine: Enigma M3, reflector UKW B
Rotor - Position - Ring: III - 9 - 3, II - 19 - 20, VI - 16 - 6 
Plugboard: dq cr bi ej kw mt os px uz gh
_________________________________________________________________



My ciphertext:
renoy begxr bczov ukkrg uasgc pkyjw sb



What is the messages? (remove spaces)
```

Tìm kiếm với từ khoá Enigma ta thấy đây là cơ chế mã hoá có nguồn gốc từ Đức, được sử dụng trong thế chiến I và thế chiến II rất nhiều.
Trong bài này thì ta đã được cho chi tiết các thông tin để [decode](https://cryptii.com/) Enigma rất dễ dàng.  
  
![Enigma Decode](/miniCTF2021/miniCTF2021_file/Chuunin-Exam/enigma.png)  
  
  
Plaintext:
```
enigmaisformilitarycommunication
```

Sau 3 stage ta đã vượt qua challenge và nhận được flag:
```
PTITkagure proud of you as a new Chuunin!
New S-rank Hiden Jutsu to you from ISP Ichizoku: ISPCLUB{s3cr3t_pr0t3ct0r}
```

Flag: ``` ISPCLUB{s3cr3t_pr0t3ct0r} ```
# Crypto: Base no jutsu
#### Challenge

Một bí thuật cơ sở bị trộn lẫn bởi Base Ichizoku để che giấu sự nhòm ngó của AkatXienPan!!! 

[Base_no_jutsu.txt](/miniCTF2021/miniCTF2021_file/Base/Baka_no_Jutsu.txt)

####  Solution

Đây là các base (là các hệ cơ số được dùng cho máy tính và mã hóa)
Ví dụ:  Base10 (DEC): 0,1,2,3,4,5,6,7,8,9

	Base2 (BIN): 0,1
	
	Base8 (OCT): 0, 1, 2, 3, 4, 5, 6, 7
	
Và 1 số base khác: Base16, base32, base64….

Sau khi mở file txt, đoạn mã được encrypt: 

```
SVNQQ0xVQns623473335f31735f6e30745fORVTI5C7MQYWMZRRMN2WY5D5
```

Đoạn mã “SVNQQ0xVQns” là base 64, decrypt ra: ISPCLUB{

Đoạn mã “623473335f31735f6e30745f” là base 16, decrypt ra: b4s3_1s_n0t_

Đoạn mã “ORVTI5C7MQYWMZRRMN2WY5D5” là base 32, decrypt ra: tk4t_d1ff1cult}

Flag: ```ISPCLUB{b4s3_1s_n0t_tk4t_d1ff1cult} ```

# Crypto: Gravity Falls Bill

#### Challenge

Đã nhiều lần ăn Ramen tại tiệm Ramen thương hiệu ISP Ichizoku, Deku Haha và bạn đến hôm nay mới để ý thấy rằng trong những tờ hóa đơn thanh toán của tiệm đều có những ký hiệu kỳ lạ. Nghe đồn đây là ấn chú mà chủ tiệm đã khắc lên để nhận biết xem tờ hóa đơn có bị sửa đổi không. Deku Haha thầm nghĩ nếu sắp tới xin gia nhập ISP Ichizoku mà biết được nó và cho vào CV thì rất có ích. Hãy giải mã nó cùng Deku Haha để làm đẹp CV sắp tới của mình nhé!!!

[encrypt.png](/miniCTF2021/miniCTF2021_file/Bill_cipher/encrypt.png)

#### Solution

Khi mở file ảnh mà đề cho, kết hợp với đoạn mô tả và tên của challenge. Ta có thể đoán được đây là mật mã bill cipher. Ở đây mình sẽ sử dụng tool [dcode.fr](https://www.dcode.fr/gravity-falls-bill-cipher) để có thể giải đoạn mã này.

![](/miniCTF2021/miniCTF2021_file/Bill_cipher/1.png)

Thêm các kí tự để đúng với đoạn mã đề cho và flag form. Ta được flag: ISPCLUB{BJLL_CJPKER}

Flag: ``` ISPCLUB{BJLL_CJPKER} ```

# Forensic: Covi no Dokumushi  

#### Challenge

Với cuốn bí thuật ăn cắp được từ Aburame Ichizoku, Hiruyzawa Kuhan đã sử dụng nó triệu hồi virus Covid tấn công PTITgakure. Ngày qua ngày số lượng ca nhiễm càng tăng lên đặt lên vai các y nhẫn giả một áp lực không hề nhẹ.  Theo thống kê, ngày 22/9 số lượng người được chữa khỏi là nhiều nhất. Là genin cũng như là người dân trong làng, liệu bạn có nắm bắt được có bao nhiêu người được chữa khỏi không ???


#### Solution

Đọc đề bài, ta thấy thấy ngay của flag cần tìm là số người đã được chữa khỏi Covid19 trong ngày 22/9. Theo đó, ta tra trên google thì số lượng người được chữa khỏi là 11919 người  
![](https://i.imgur.com/hlyVWxL.png)  
Flag: ``` ISPCLUB{11919} ```

# Daichidoukaku - Forensic
#### Description
 Tam Vĩ đang nổi điên. Chắc chắn là do Hiruyzawa Kuhan đã cho nó say thuốc. Trong lúc đợi các y nhẫn giả đến và chữa trị cho nó, bạn và hàng trăm genin gần đó có nhiệm vụ cùng nhau thi triển 1 nhẫn thuật để mặt đất rung chuyển và tách ra nhằm làm kìm chân Tam Vĩ, không để nó tiến vào trong làng.
 
[Supuritto_no_Jutsu](img/Supuritto_no_Jutsu.gif)

#### Solution
- Từ file gif được cung cấp ta có thể thấy 1 mã QR thoáng qua rất nhanh.                   
![](/miniCTF2021/miniCTF2021_file/Daichidoukaku/img/Supuritto_no_Jutsu.gif)
- Từ đây có thể căn để dừng gif đúng lúc mã QR xuất hiện hoặc có thể dùng https://ezgif.com/split để tách gif 
![](/miniCTF2021/miniCTF2021_file/Daichidoukaku/img/1.png)
- Quét mã QR nhận được flag
- Flag: ``` ISPCLUB{5p1it_91f} ```





